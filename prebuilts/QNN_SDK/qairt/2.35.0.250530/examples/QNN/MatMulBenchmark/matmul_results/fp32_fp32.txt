=================================================================
Comprehensive NPU MatMul Benchmark - All LLM Patterns
Input A dtype: fp32, Input B dtype: fp32
Iterations per test: 30
=================================================================

Running 52 total test cases...

=== Attention [seq x 4096] x [4096 x seq] ===
Seq      Time(ms)     GFLOPS       Status  
--------------------------------------------
[  1/ 52] Testing seq=1... 1        0.45         0.02         OK      
[  2/ 52] Testing seq=2... 2        0.65         0.05         OK      
[  3/ 52] Testing seq=4... 4        0.62         0.21         OK      
[  4/ 52] Testing seq=8... 8        0.83         0.63         OK      
[  5/ 52] Testing seq=16... 16       0.88         2.38         OK      
[  6/ 52] Testing seq=32... 32       1.01         8.28         OK      
[  7/ 52] Testing seq=64... 64       1.22         27.45        OK      
[  8/ 52] Testing seq=128... 128      1.72         78.03        OK      
[  9/ 52] Testing seq=256... 256      4.32         124.42       OK      
[ 10/ 52] Testing seq=512... 512      11.72        183.29       OK      
[ 11/ 52] Testing seq=1024... 1024     30.81        278.80       OK      
[ 12/ 52] Testing seq=2048... 2048     80.86        424.93       OK      
[ 13/ 52] Testing seq=4096... 4096     322.64       425.99       OK      

=== Linear [seq x 4096] x [4096 x 4096] ===
Seq      Time(ms)     GFLOPS       Status  
--------------------------------------------
[ 14/ 52] Testing seq=1... 1        35.05        0.96         OK      
[ 15/ 52] Testing seq=2... 2        42.97        1.56         OK      
[ 16/ 52] Testing seq=4... 4        40.23        3.34         OK      
[ 17/ 52] Testing seq=8... 8        35.99        7.46         OK      
[ 18/ 52] Testing seq=16... 16       51.91        10.34        OK      
[ 19/ 52] Testing seq=32... 32       34.96        30.72        OK      
[ 20/ 52] Testing seq=64... 64       51.36        41.81        OK      
[ 21/ 52] Testing seq=128... 128      36.92        116.32       OK      
[ 22/ 52] Testing seq=256... 256      58.07        147.93       OK      
[ 23/ 52] Testing seq=512... 512      77.21        222.52       OK      
[ 24/ 52] Testing seq=1024... 1024     107.16       320.65       OK      
[ 25/ 52] Testing seq=2048... 2048     160.46       428.27       OK      
[ 26/ 52] Testing seq=4096... 4096     329.15       417.56       OK      

=== FFN_Up [seq x 4096] x [4096 x 11008] ===
Seq      Time(ms)     GFLOPS       Status  
--------------------------------------------
[ 27/ 52] Testing seq=1... 1        201.63       0.45         OK      
[ 28/ 52] Testing seq=2... 2        199.65       0.90         OK      
[ 29/ 52] Testing seq=4... 4        197.16       1.83         OK      
[ 30/ 52] Testing seq=8... 8        206.51       3.49         OK      
[ 31/ 52] Testing seq=16... 16       187.58       7.69         OK      
[ 32/ 52] Testing seq=32... 32       179.92       16.04        OK      
[ 33/ 52] Testing seq=64... 64       188.08       30.69        OK      
[ 34/ 52] Testing seq=128... 128      191.91       60.15        OK      
[ 35/ 52] Testing seq=256... 256      216.85       106.46       OK      
[ 36/ 52] Testing seq=512... 512      264.41       174.62       OK      
[ 37/ 52] Testing seq=1024... 1024     317.88       290.50       OK      
[ 38/ 52] Testing seq=2048... 2048     435.57       424.01       OK      
[ 39/ 52] Testing seq=4096... 4096     813.63       453.97       OK      

=== FFN_Down [seq x 11008] x [11008 x 4096] ===
Seq      Time(ms)     GFLOPS       Status  
--------------------------------------------
[ 40/ 52] Testing seq=1... 1        142.95       0.63         OK      
[ 41/ 52] Testing seq=2... 2        175.98       1.02         OK      
[ 42/ 52] Testing seq=4... 4        170.45       2.12         OK      
[ 43/ 52] Testing seq=8... 8        176.55       4.09         OK      
[ 44/ 52] Testing seq=16... 16       147.61       9.77         OK      
[ 45/ 52] Testing seq=32... 32       121.14       23.82        OK      
[ 46/ 52] Testing seq=64... 64       134.36       42.95        OK      
[ 47/ 52] Testing seq=128... 128      175.37       65.82        OK      
[ 48/ 52] Testing seq=256... 256      223.41       103.33       OK      
[ 49/ 52] Testing seq=512... 512      260.87       176.99       OK      
[ 50/ 52] Testing seq=1024... 1024     335.90       274.91       OK      
[ 51/ 52] Testing seq=2048... 2048     530.49       348.14       OK      
[ 52/ 52] Testing seq=4096... 4096     860.37       429.31       OK      


=================================================================
COMPREHENSIVE SUMMARY REPORT - GFLOPS
=================================================================

Attention [seq x 4096] x [4096 x seq]:
Seq      GFLOPS      
---------------------
1        0.02        
2        0.05        
4        0.21        
8        0.63        
16       2.38        
32       8.28        
64       27.45       
128      78.03       
256      124.42      
512      183.29      
1024     278.80      
2048     424.93      
4096     425.99      

Linear [seq x 4096] x [4096 x 4096]:
Seq      GFLOPS      
---------------------
1        0.96        
2        1.56        
4        3.34        
8        7.46        
16       10.34       
32       30.72       
64       41.81       
128      116.32      
256      147.93      
512      222.52      
1024     320.65      
2048     428.27      
4096     417.56      

FFN_Up [seq x 4096] x [4096 x 11008]:
Seq      GFLOPS      
---------------------
1        0.45        
2        0.90        
4        1.83        
8        3.49        
16       7.69        
32       16.04       
64       30.69       
128      60.15       
256      106.46      
512      174.62      
1024     290.50      
2048     424.01      
4096     453.97      

FFN_Down [seq x 11008] x [11008 x 4096]:
Seq      GFLOPS      
---------------------
1        0.63        
2        1.02        
4        2.12        
8        4.09        
16       9.77        
32       23.82       
64       42.95       
128      65.82       
256      103.33      
512      176.99      
1024     274.91      
2048     348.14      
4096     429.31      

=================================================================
COMPREHENSIVE SUMMARY REPORT - TIME (ms)
=================================================================

Attention [seq x 4096] x [4096 x seq]:
Seq      Time(ms)    
---------------------
1        0.45        
2        0.65        
4        0.62        
8        0.83        
16       0.88        
32       1.01        
64       1.22        
128      1.72        
256      4.32        
512      11.72       
1024     30.81       
2048     80.86       
4096     322.64      

Linear [seq x 4096] x [4096 x 4096]:
Seq      Time(ms)    
---------------------
1        35.05       
2        42.97       
4        40.23       
8        35.99       
16       51.91       
32       34.96       
64       51.36       
128      36.92       
256      58.07       
512      77.21       
1024     107.16      
2048     160.46      
4096     329.15      

FFN_Up [seq x 4096] x [4096 x 11008]:
Seq      Time(ms)    
---------------------
1        201.63      
2        199.65      
4        197.16      
8        206.51      
16       187.58      
32       179.92      
64       188.08      
128      191.91      
256      216.85      
512      264.41      
1024     317.88      
2048     435.57      
4096     813.63      

FFN_Down [seq x 11008] x [11008 x 4096]:
Seq      Time(ms)    
---------------------
1        142.95      
2        175.98      
4        170.45      
8        176.55      
16       147.61      
32       121.14      
64       134.36      
128      175.37      
256      223.41      
512      260.87      
1024     335.90      
2048     530.49      
4096     860.37      

=================================================================
All Patterns Benchmark Complete
=================================================================
