=================================================================
Comprehensive NPU MatMul Benchmark - All LLM Patterns
Input A dtype: fp16, Input B dtype: fp16
Iterations per test: 30
=================================================================

Running 52 total test cases...

=== Attention [seq x 4096] x [4096 x seq] ===
Seq      Time(ms)     GFLOPS       Status  
--------------------------------------------
[  1/ 52] Testing seq=1... 1        0.49         0.02         OK      
[  2/ 52] Testing seq=2... 2        0.50         0.07         OK      
[  3/ 52] Testing seq=4... 4        0.44         0.29         OK      
[  4/ 52] Testing seq=8... 8        0.52         1.01         OK      
[  5/ 52] Testing seq=16... 16       0.47         4.46         OK      
[  6/ 52] Testing seq=32... 32       0.50         16.81        OK      
[  7/ 52] Testing seq=64... 64       0.86         38.82        OK      
[  8/ 52] Testing seq=128... 128      1.12         120.16       OK      
[  9/ 52] Testing seq=256... 256      1.78         301.64       OK      
[ 10/ 52] Testing seq=512... 512      4.73         453.81       OK      
[ 11/ 52] Testing seq=1024... 1024     11.51        746.31       OK      
[ 12/ 52] Testing seq=2048... 2048     34.31        1001.54      OK      
[ 13/ 52] Testing seq=4096... 4096     175.41       783.53       OK      

=== Linear [seq x 4096] x [4096 x 4096] ===
Seq      Time(ms)     GFLOPS       Status  
--------------------------------------------
[ 14/ 52] Testing seq=1... 1        24.62        1.36         OK      
[ 15/ 52] Testing seq=2... 2        24.24        2.77         OK      
[ 16/ 52] Testing seq=4... 4        23.99        5.60         OK      
[ 17/ 52] Testing seq=8... 8        23.33        11.50        OK      
[ 18/ 52] Testing seq=16... 16       15.35        34.97        OK      
[ 19/ 52] Testing seq=32... 32       15.49        69.32        OK      
[ 20/ 52] Testing seq=64... 64       15.99        134.33       OK      
[ 21/ 52] Testing seq=128... 128      18.11        237.15       OK      
[ 22/ 52] Testing seq=256... 256      21.79        394.26       OK      
[ 23/ 52] Testing seq=512... 512      31.40        547.12       OK      
[ 24/ 52] Testing seq=1024... 1024     49.15        699.08       OK      
[ 25/ 52] Testing seq=2048... 2048     161.48       425.57       OK      
[ 26/ 52] Testing seq=4096... 4096     167.80       819.07       OK      

=== FFN_Up [seq x 4096] x [4096 x 11008] ===
Seq      Time(ms)     GFLOPS       Status  
--------------------------------------------
[ 27/ 52] Testing seq=1... 1        99.60        0.91         OK      
[ 28/ 52] Testing seq=2... 2        96.57        1.87         OK      
[ 29/ 52] Testing seq=4... 4        98.12        3.68         OK      
[ 30/ 52] Testing seq=8... 8        95.54        7.55         OK      
[ 31/ 52] Testing seq=16... 16       57.04        25.30        OK      
[ 32/ 52] Testing seq=32... 32       55.25        52.23        OK      
[ 33/ 52] Testing seq=64... 64       62.87        91.80        OK      
[ 34/ 52] Testing seq=128... 128      59.13        195.22       OK      
[ 35/ 52] Testing seq=256... 256      75.17        307.09       OK      
[ 36/ 52] Testing seq=512... 512      83.06        555.91       OK      
[ 37/ 52] Testing seq=1024... 1024     178.92       516.12       OK      
[ 38/ 52] Testing seq=2048... 2048     418.82       440.96       OK      
[ 39/ 52] Testing seq=4096... 4096     541.11       682.61       OK      

=== FFN_Down [seq x 11008] x [11008 x 4096] ===
Seq      Time(ms)     GFLOPS       Status  
--------------------------------------------
[ 40/ 52] Testing seq=1... 1        55.56        1.62         OK      
[ 41/ 52] Testing seq=2... 2        49.43        3.65         OK      
[ 42/ 52] Testing seq=4... 4        57.32        6.29         OK      
[ 43/ 52] Testing seq=8... 8        55.74        12.94        OK      
[ 44/ 52] Testing seq=16... 16       45.19        31.93        OK      
[ 45/ 52] Testing seq=32... 32       45.04        64.06        OK      
[ 46/ 52] Testing seq=64... 64       46.57        123.93       OK      
[ 47/ 52] Testing seq=128... 128      53.90        214.13       OK      
[ 48/ 52] Testing seq=256... 256      68.70        336.02       OK      
[ 49/ 52] Testing seq=512... 512      112.26       411.28       OK      
[ 50/ 52] Testing seq=1024... 1024     177.17       521.20       OK      
[ 51/ 52] Testing seq=2048... 2048     364.67       506.44       OK      
[ 52/ 52] Testing seq=4096... 4096     842.11       438.62       OK      


=================================================================
COMPREHENSIVE SUMMARY REPORT - GFLOPS
=================================================================

Attention [seq x 4096] x [4096 x seq]:
Seq      GFLOPS      
---------------------
1        0.02        
2        0.07        
4        0.29        
8        1.01        
16       4.46        
32       16.81       
64       38.82       
128      120.16      
256      301.64      
512      453.81      
1024     746.31      
2048     1001.54     
4096     783.53      

Linear [seq x 4096] x [4096 x 4096]:
Seq      GFLOPS      
---------------------
1        1.36        
2        2.77        
4        5.60        
8        11.50       
16       34.97       
32       69.32       
64       134.33      
128      237.15      
256      394.26      
512      547.12      
1024     699.08      
2048     425.57      
4096     819.07      

FFN_Up [seq x 4096] x [4096 x 11008]:
Seq      GFLOPS      
---------------------
1        0.91        
2        1.87        
4        3.68        
8        7.55        
16       25.30       
32       52.23       
64       91.80       
128      195.22      
256      307.09      
512      555.91      
1024     516.12      
2048     440.96      
4096     682.61      

FFN_Down [seq x 11008] x [11008 x 4096]:
Seq      GFLOPS      
---------------------
1        1.62        
2        3.65        
4        6.29        
8        12.94       
16       31.93       
32       64.06       
64       123.93      
128      214.13      
256      336.02      
512      411.28      
1024     521.20      
2048     506.44      
4096     438.62      

=================================================================
COMPREHENSIVE SUMMARY REPORT - TIME (ms)
=================================================================

Attention [seq x 4096] x [4096 x seq]:
Seq      Time(ms)    
---------------------
1        0.49        
2        0.50        
4        0.44        
8        0.52        
16       0.47        
32       0.50        
64       0.86        
128      1.12        
256      1.78        
512      4.73        
1024     11.51       
2048     34.31       
4096     175.41      

Linear [seq x 4096] x [4096 x 4096]:
Seq      Time(ms)    
---------------------
1        24.62       
2        24.24       
4        23.99       
8        23.33       
16       15.35       
32       15.49       
64       15.99       
128      18.11       
256      21.79       
512      31.40       
1024     49.15       
2048     161.48      
4096     167.80      

FFN_Up [seq x 4096] x [4096 x 11008]:
Seq      Time(ms)    
---------------------
1        99.60       
2        96.57       
4        98.12       
8        95.54       
16       57.04       
32       55.25       
64       62.87       
128      59.13       
256      75.17       
512      83.06       
1024     178.92      
2048     418.82      
4096     541.11      

FFN_Down [seq x 11008] x [11008 x 4096]:
Seq      Time(ms)    
---------------------
1        55.56       
2        49.43       
4        57.32       
8        55.74       
16       45.19       
32       45.04       
64       46.57       
128      53.90       
256      68.70       
512      112.26      
1024     177.17      
2048     364.67      
4096     842.11      

=================================================================
All Patterns Benchmark Complete
=================================================================
